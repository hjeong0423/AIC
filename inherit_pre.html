<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Nanum+Gothic:wght@700&display=swap" rel="stylesheet">
    <title>AI Calculators</title>
    <script src="https://kit.fontawesome.com/4066a8ec03.js" crossorigin="anonymous"></script>
    <script src="main.js" defer></script>

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-KK94CHFLLe+nY2dmCWGMq91rCGa5gtU4mk92HdvYe+M/SXH301p5ILy+dN9+nJOZ" crossorigin="anonymous">

    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="report-result.css">

    <style>
/*        body {
            font-family: '맑은 고딕', sans-serif;
            background-color: #f0f0f0;
            margin: 0;
            padding: 0;
        }


body {
            font-family: '맑은 고딕', sans-serif;
            background-color: #f0f0f0;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            margin: 0;
        }
*/
        .cover {
            background-color: white;
            padding: 40px;
            border-radius: 10px;
            box-shadow: 0 0 10px rgba(0,0,0,0.1);
            text-align: center;
        }
        h1 {
            font-size: 24px;
            color: #333;
            margin-bottom: 100px;
        }
        .company, .date {
            text-align: right;
            margin-top: 10px;
        }
        .footer {
            margin-top: 50px;
            font-size: 12px;
            color: #666;
        }
        .footer strong {
            color: #333;
        }

        body {
            font-family: 'Nanum Gothic', sans-serif;
            line-height: 1.6;
            color: #333;
        }

        .post-content {
            margin-top: 20px;
        }
        .subTitle {
            color: #17212b;
            font-size: 18px;
            font-family:'Nanum Square';
            font-weight: bold;
        }
        .checkbox-list {
            list-style-type: none;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;

        }
        .checkbox-list li {
            margin-bottom: 10px;
            padding-left: 0;
        }
        .checkbox-caption {
            width: 100%;
            margin-top: 20px;
            font-size: 14px;
            font-weight: normal;
            font-family:'Nanum Square';
        }
        .input-block {
            margin-left: 20px;
            margin-top: 10px;
            display: none;
        }
        .input-block input[type="text"] {
            width: 200px;
            padding: 5px;
 
            border: none;
            border-bottom: 1px solid #ccc; /* 아래 밑줄 색상과 두께 지정 */
            outline: none; /* 포커스 시 나타나는 외곽선 제거 */
            text-align: right; /* 텍스트 우측 정렬 */
            width: 130px;
            padding-right: 5px;
            display: inline-flex; /* 또는 display: block; */
        }
        .input-block textarea {
            width: 100%;
            height: 60px;
            margin-top: 5px;
        }
/*        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }
        th, td {
            border: 1px solid #ddd;
            padding: 8px;
            text-align: left;
        }
        th {
            background-color: #f2f2f2;
        }
*/
        input[type="text"] {
            width: 200px;
            padding: 5px;
 
            border: none;
            border-bottom: 1px solid #ccc; /* 아래 밑줄 색상과 두께 지정 */
            outline: none; /* 포커스 시 나타나는 외곽선 제거 */
            text-align: right; /* 텍스트 우측 정렬 */
            width: 130px;
            padding-right: 5px;
            display: inline-flex; /* 또는 display: block; */
        }
        label {
            font-weight: normal;
        }
        #resultPage {
            display: none;
        }

    </style>

</head>
<body>
    <cal_menu class="main_menu">
        <div class="menu_logo">
            <i class="fa-solid fa-calculator"></i>
            <a href="#">AI Calculator</a>
        </div>
        <ul class="menu_list">
            <li><a href="inherit_pre.html">상속세 프리미엄</a></li>
            <li><a href="inherit_report.html">상속세 보고서</a></li>
            <li><a href="PostingCalc.html">포스팅 + 계산기</a></li>
          </ul>
        <a href="#" class="toggle_bar"><i class="fa-solid fa-bars"></i></a>
    </cal_menu>

  <!--page begin -->

<!--입력페이지 시작-->
<div class="container"> <!-- my-5 클래스 추가 -->
    <div class="row">
            <div class="col-md-8 offset-md-2">
                <div class="post-content py-5"> <!-- py-5 클래스 추가 -->
    

    <div id="inputPage" class="post-content">

  <form id="inheritanceForm">

    <h1>상속세 프리미엄 보고서 입력</h1>

  <p style="margin:0cm 0cm 10pt; text-align:justify">&nbsp;</p>
  
  <p style="margin-bottom:.0001pt; margin:0cm 0cm 10pt; text-align:justify"><span style="font-size:16px;"><span style="line-height:150%"><span style="font-family:Nanum Square;"><span style="line-height:150%">부모님 중 한 분이 먼저 돌아가신 경우를 먼저 알아보도록 하겠습니다. 배우자가 생존<input type="text" id="spouse" name="spouse" value="1" style="display:none;">해 있으며, 상속인이 되는 자녀의 수는 <input type="text" id="children" name="children" oninput="formatNumber(this)" value="2">명이며, 주택은 1채만을 소유하고 있고&nbsp;사망시 거래가액은 <input type="text" id="house_value" name="house_value" oninput="formatNumber(this)" value="2,000,000,000" >원 입니다.</span></span></span></span></p>
  
  <p style="margin-bottom:.0001pt; margin:0cm 0cm 10pt; text-align:justify"><span style="font-size:16px;"><span style="line-height:150%"><span style="font-family:Nanum Square;"><span style="line-height:150%">봉안시설 등에 소요된 금액은 <input type="text" id="funeral_facility" name="funeral_facility" oninput="formatNumber(this)" value="5,000,000">원이며, 이를 제외한 총 장례비용은 <input type="text" id="funeral_cost" name="funeral_cost" oninput="formatNumber(this)" value="5,000,000">원 입니다.</span></span></span></span></p>
  
  <p style="margin-bottom:.0001pt; margin:0cm 0cm 10pt; text-align:justify"><span style="font-size:16px;"><span style="line-height:150%"><span style="font-family:Nanum Square;"><span style="line-height:150%">( &diams; 자산 및 부채 등의 가액은 사망일이 기준이 되며, 사망신고일이 아님을 유의하시기 바랍니다.)</span></span></span></span></p>
  
  <p style="margin-bottom:.0001pt; margin:0cm 0cm 10pt; text-align:justify">&nbsp;</p>
  
  <p style="margin-bottom:.0001pt; margin:0cm 0cm 10pt; text-align:justify"><span style="font-size:16px;"><span style="line-height:150%"><span style="font-family:Nanum Square;"><span style="line-height:150%; font-weight: bold;">기타 상속재산이 있는 경우에는 아래 해당항목을 클릭하여 입력하여 주시면 됩니다.</span></span></span></span></p>
  
  <p style="margin-bottom:.0001pt; margin:0cm 0cm 10pt; text-align:justify"><span style="font-size:16px;"><span style="line-height:150%"><span style="font-family:Nanum Square;"><span style="line-height:150%; font-weight: bold;">* 추가자산, 채무 및 비용의 입력</span></span></span></span></p>
  
  <ul class="checkbox-list">
    <li>
        <input type="checkbox" id="building" name="building" class="toggle-input">
        <label style="font-size: 16; font-family:Nanum Square;" for="building">비거주용 건물(대지포함)</label>
        <div class="input-block">
            <input type="text" id="building_value" name="building_value" class="input-block-value" oninput="formatNumber(this)" placeholder="금액 입력">원
                <ul class="checkbox-caption">
                    <li>시가로 평가.</li>
                    <li>감정평가가액이 있는 경우 감정가액.</li>
                    <li>시가가 없는 경우 기준시가로 평가.</li>
                    <li>고가의 건물의 경우, 2020년부터 기준시가로 과세하는 것에 대한 과세 형평성 문제가 제기되었습니다.</li>
                    <li>국세청은 자체 감정평가예산을 배정하여 예상감정가와 시가의 차액이 10억을 넘거나 , 10%이상 차이가 나는 경우 감정평가를 하여 과세하고 있습니다.</li>
                </ul>
        </div>
    </li>
    <li>
        <input type="checkbox" id="farmland" name="farmland" class="toggle-input">
        <label style="font-size: 16; font-family:Nanum Square;" for="farmland">농지</label>
        <div class="input-block">
            <input type="text" id="farmland_value" name="farmland_value" class="input-block-value" oninput="formatNumber(this)" placeholder="금액 입력">원
            <ul class="checkbox-caption">
                <li>실제 거래가액인 시가로 입력합니다.</li>
                <li>시가는 감정평가액이 될 수도 있습니다.</li>
                <li>시가가 없는 경우 공시지가를 입력합니다.</li>            
            </ul>
    </div>
    </li>
    <li>
        <input type="checkbox" id="forest" name="forest" class="toggle-input">
        <label style="font-size: 16; font-family:Nanum Square;" for="forest">임야(산)</label>
        <div class="input-block">
            <input type="text" id="forest_value" name="forest_value" class="input-block-value" oninput="formatNumber(this)" placeholder="금액 입력">원
            <ul class="checkbox-caption">
                <li>실제 거래가액인 시가로 입력합니다.</li>
                <li>시가는 감정평가액이 될 수도 있습니다.</li>
                <li>시가가 없는 경우 공시지가를 입력합니다.</li>            
            </ul>
        </div>
    </li>
    <li>
        <input type="checkbox" id="financial" name="financial" class="toggle-input">
        <label style="font-size: 16; font-family:Nanum Square;" for="financial">금융자산 등 그외 상속재산</label>
        <div class="input-block">
            <input type="text" id="financial_value" name="financial_value" class="input-block-value" oninput="formatNumber(this)" placeholder="금액 입력">원
            <ul class="checkbox-caption">
                <li>순금융재산의 가액이 2천만원 초과일 경우: 순금융재산 가액의 20% 혹은 2천만원 중 더 큰 금액이 공제됩니다. 단, 이 공제 금액은 최대 2억원까지입니다.</li>
                <li>순금융재산의 가액이 2천만원 이하일 경우: 순금융재산의 전액이 과세가액에서 공제됩니다.</li>
            </ul>
        </div>
    </li>
    <li>
        <input type="checkbox" id="debt" name="debt" class="toggle-input">
        <label style="font-size: 16; font-family:Nanum Square;" for="debt">채무 및 공과금</label>
        <div class="input-block">
            <input type="text" id="debt_value" name="debt_value" class="input-block-value" oninput="formatNumber(this)" placeholder="금액 입력">원
        </div>
    </li>
    <li>
        <input type="checkbox" id="spouse_gift" name="spouse_gift" class="toggle-input">
        <label style="font-size: 16; font-family:Nanum Square;" for="spouse_gift">10년 이내 배우자 증여금액</label>
        <div class="input-block">
            <input type="text" id="spouse_gift_value" name="spouse_gift_value" class="input-block-value" oninput="formatNumber(this)" placeholder="금액 입력">원
        </div>
    </li>
    <li>
        <input type="checkbox" id="child_gift" name="child_gift" class="toggle-input">
        <label style="font-size: 16; font-family:Nanum Square;" for="child_gift">10년 이내 자녀 증여금액</label>
        <div class="input-block">
            <input type="text" id="child_gift_value" name="child_gift_value" class="input-block-value" oninput="formatNumber(this)" placeholder="금액 입력">원
        </div>
    </li>
    <li>
        <input type="checkbox" id="other_gift" name="other_gift" class="toggle-input">
        <label style="font-size: 16; font-family:Nanum Square;" for="other_gift">5년 이내 상속인외 증여금액(손자,손녀 등)</label>
        <div class="input-block">
            <input type="text" id="other_gift_value" name="other_gift_value" class="input-block-value" oninput="formatNumber(this)" placeholder="금액 입력">원
        </div>
    </li>
    <li>
        <input type="checkbox" id="appraisal_fee" name="appraisal_fee" class="toggle-input">
        <label style="font-size: 16; font-family:Nanum Square;" for="appraisal_fee">감정평가수수료</label>
        <div class="input-block">
            <input type="text" id="appraisal_fee_value" name="appraisal_fee_value" class="input-block-value" oninput="formatNumber(this)" placeholder="금액 입력">원
            <ul class="checkbox-caption">
                <li>최대 한도액은 500만원입니다.</li>
            </ul>
        </div>
    </li>
    <li>
        <input type="checkbox" id="pre_paid_tax" name="pre_paid_tax" class="toggle-input">
        <label style="font-size: 16; font-family:Nanum Square;" for="pre_paid_tax">사전 증여 시 납부한 세액</label>
        <div class="input-block">
            <input type="text" id="pre_paid_tax_value" name="pre_paid_tax_value" class="input-block-value" oninput="formatNumber(this)" placeholder="금액 입력">원
        </div>
    </li>
</ul>

<div style="text-align: center; margin-top: 30px;">
    <button class="fixedButton" type="button" onclick="getInput()" >상속세 프리미엄 보고서 보기</button>
</div>

<p style="margin:0cm 0cm 10pt; text-align:justify">&nbsp;</p>

  </form>
    </div> <!-- end of inputPage-->
</div></div></div></div>


<!--결과페이지 시작-->
<div class="container"> <!-- my-5 클래스 추가 -->
    <div class="row col-12">
            <div class="col-md-10 offset-md-1">
                <div class="post-content py-5"> <!-- py-5 클래스 추가 -->
    <div id="resultPage" class="post-content">
    <!--표지-->
    <div class="cover">
        <h1>상속세 프리미엄 보고서</h1>
        <div class="company">대한세무법인</div>
        <div id="today" class="date">
            <script>
                const today = new Date();
                const dateString = today.toLocaleDateString('ko-KR');
                document.getElementById('today').innerHTML = dateString;
            </script>
        </div>
        <div class="footer">
            <p>본 보고서는 작성일 현재의 세법과 기본전제사항을 기준으로 <strong>참고목적</strong>으로 작성되었습니다.</p>
            <p><strong>실제의사결정 및 세금신고는 반드시 세무전문가와 상담하시길 바랍니다.</strong></p>
        </div>
    </div>


    <!--입력-->
    <div class="col-12 pt-5" style="margin-top: 80px">
        <div class="subTitle">1. 기본 전제사항 및 입력내용</div>
    </div>
    <div style="padding-left: 20px;" class="pt-3">
        <table id="resultTable" class="result-table col-md-8">
            <thead >
            <tr class="table-head-hk">
                <th>구 분</th>
                <th>금 액</th>
            </tr>
            </thead>
            <tbody>
                <!-- 여기에 JavaScript로 결과를 동적으로 추가합니다 -->
            </tbody>
        </table>
    </div>

    <!--상속세-->
    <div class="col-12 pt-5" style="margin-top: 80px">
        <div class="subTitle">2. 상속세 절세</div>
    </div>
    <div class="report-container col-12 pt-5">
        <div>◈ 인적 상속공제의 활용</div>
        <div style="padding-left: 20px;" class="description pt-3">
            <p>- 기본적으로 배우자가 생존해 있는 경우에 최소 10억원의 상속공제가 가능합니다. 다만, 사전증여가 존재하는 경우에는 10억이 안될 수가 있습니다</p>
            <p> - 배우자상속공제를 활용할 수 있습니다. 30억까지 가능하며, 실제 상속받은금액과 법정상속분을 한도로 하고 있습니다. 만일 배우자 상속액이 5억원 이하일 경우에는 5억원을 공제하게 됩니다.</p>
            <p> - 기타상속공제 활용시의 차이를 보기위해 여기에서는 금융상속공제, 동거주택상속공제는 제외하였습니다.</p>
        </div>
        <div style="padding-left: 20px;" class="description pt-3">
            <p> - 인적공제를 통한 상속세 계산내역<br>: 여기에서는 기본으로 10억원의 상속공제를 받는 경우와 배우자상속공제를 최대로 활용하는 경우를 비교하여 계산하였습니다. </p>
            <p>
                <table class="result-table col-md-12">
                    <thead >
                    <tr class="table-head-hk">
                        <th>구 분</th>
                        <th>10억 공제</th>
                        <th>배우자공제 활용</th>
                        <th>참 고</th>
                    </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>(1) 총 상속재산가액</td>
                            <td class = "amount-align-hk" id="totalValue0"></td>
                            <td class = "amount-align-hk" id="totalValue1"></td>
                            <td>입력한 상속재산 총합</td>
                        </tr>
                        <tr>
                            <td>(2) 장례비용,채무 및 공과금</td>
                            <td class = "amount-align-hk" id="tax_free0"></td>
                            <td class = "amount-align-hk" id="tax_free1"></td>
                            <td>장례비최소500만원</td>
                        </tr>
                        <tr>
                            <td>(3) 상속세 과세가액</td>
                            <td class = "amount-align-hk" id="tax_price0"></td>
                            <td class = "amount-align-hk" id="tax_price1"></td>
                            <td></td>
                        </tr>
                        <tr>
                            <td>(4) 상속공제 소계</td>
                            <td class = "amount-align-hk" >100,000,000</td>
                            <td class = "amount-align-hk" id="tax_dedct"></td>
                            <td></td>
                        </tr>
                        <tr>
                            <td style="padding-left: 20px;"> - 배우자공제</td>
                            <td></td>
                            <td class = "amount-align-hk" id="spouse_dedct"></td>
                            <td>최소5억, 최대 30억</td>
                        </tr>
                        <tr>
                            <td style="padding-left: 20px;"> - 인적공제</td>
                            <td></td>
                            <td class = "amount-align-hk" id="family_dedct"></td>
                            <td></td>
                        </tr>
                        <tr>
                            <td>(5) 감정평가수수료</td>
                            <td class = "amount-align-hk" id="app_fee0"></td>
                            <td class = "amount-align-hk" id="app_fee1"></td>
                            <td></td>
                        </tr>
                        <tr>
                            <td>(6) 상속세 과세표준</td>
                            <td class = "amount-align-hk" id="tax_base0"></td>
                            <td class = "amount-align-hk" id="tax_base1"></td>
                            <td>(3) - (4) - (5)</td>
                        </tr>
                        <tr>
                            <td>(7) 세율</td>
                            <td class = "amount-align-hk" id="tax_rate0"></td>
                            <td class = "amount-align-hk" id="tax_rate1"></td>
                            <td>누진세율공제</td>
                        </tr>
                        <tr>
                            <td>(8) 누진공제액</td>
                            <td class = "amount-align-hk" id="tax_acc_dedct0"></td>
                            <td class = "amount-align-hk" id="tax_acc_dedct1"></td>
                            <td></td>
                        </tr>
                        <tr>
                            <td>(9) 산출세액</td>
                            <td class = "amount-align-hk" id="cal_tax0"></td>
                            <td class = "amount-align-hk" id="cal_tax1"></td>
                            <td></td>
                        </tr>
                        <tr>
                            <td>(10) 세액공제</td>
                            <td class = "amount-align-hk" id="cal_tax_dedct0"></td>
                            <td class = "amount-align-hk" id="cal_tax_dedct1"></td>
                            <td>자진신고3%공제,사전증여세</td>
                        </tr>
                        <tr class="table-tail-hk">
                            <td>(11) 자진납부 세액</td>
                            <td class = "amount-align-hk" id="pay_tax0"></td>
                            <td class = "amount-align-hk" id="pay_tax1"></td>
                            <td>최종 납부할 세액</td>
                        </tr>
                    </tbody>
                </table>
            </p>
            <p class="result-description pt-2"> 이를 기준으로 상속세가 <b id="pay_tax0_p"></b>원에서 <b id="pay_tax1_p"></b>원으로 <b>배우자공제활용</b>을 통해 <b id="pay_tax_margin0"></b>원이  절세됩니다.
            </p>
        </div>
    </div> 
    <div class="report-container col-12 pt-5">
        <div>◈ 기타 상속공제의 활용</div>
        <div style="padding-left: 20px;" class="description pt-3">
            <p>- 그외에 금융상속공제, 동거주택상속공제에 해당 될 경우 추가로 공제가 가능합니다.</p>
        </div>
        <div style="padding-left: 20px;" class="description pt-3">
            <p><strong> [ 금융상속공제 ]  </strong></p>
            <p> - 순금융재산은 금융재산(예적금, 주식, 증권, 보험금 등)에서 금융채무를 제한 금액이 공제됩니다.
                <p  style="padding-left: 20px;">
                1) 순금융재산이 2천만원이하일 경우: 순금융재산 전액이 공제됩니다.<br>
                2) 순금융재산이 2천만원을 초과하는 경우: 순금융재산 가액의 20% 혹은 2천만원 중 더 큰 금액을 공제합니다. 단, 2억원한도입니다.
                </p>
            </p>
            <p>- (간편계산) 편의를 위해 입력하신 내용을 바탕으로한 추측한 금융재산은 다음과 같습니다.(금융자산 등 그외 상속재산을 금융재산으로, 채무및공과금을 금융채무로 간주하였습니다) 
                <div style="padding-left: 20px;">
                    <table class="result-table col-md-8">
                        <thead >
                        <tr class="table-head-hk">
                            <th>구 분</th>
                            <th>금 액</th>
                        </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>금융재산</td>
                                <td class = "amount-align-hk" id="financial_value_p"></td>
                            </tr>
                            <tr>
                                <td>금융채무</td>
                                <td class = "amount-align-hk" id="debt_value_p"></td>
                            </tr>
                            <tr>
                                <td>순금융재산</td>
                                <td class = "amount-align-hk" id="net_value_p"></td>
                            </tr>
                            <tr>
                                <td>금융공제액</td>
                                <td class = "amount-align-hk" id="fin_dedct_p" ></td>
                            </tr>
                        </tbody>
                    </table>
                    <p class="result-description pt-2"> 이를 기준으로 상속세가 <b id="pay_tax_fin1"></b>원에서 <b id="pay_tax_fin2"></b>원으로 <b id="pay_tax_margin"></b>원 절세됩니다.
                    </p>
                </div>
            </p>
            <p>- (정확한계산) 입력하신 "금융자산 등 그외 상속재산 가액"에서 실제 금융재산과 "채무 및 공과금 가액"에서 실제 금융채무 만을 아래에 입력하여 더욱 정확한 결과를 확인할 수 있습니다. 
                <div  style="padding-left: 20px;">
                    금융재산 가액: <input type="text" id="financial_exact" name="financial_exact" oninput="formatNumber(this)" onchange="CalFinDedct('message1','message2')">원
                    <span id="message1" class="message"></span>
                </div>
                <div  style="padding-left: 20px;">
                    금융채무 가액: <input type="text" id="fin_debt_exact" name="fin_debt_exact" oninput="formatNumber(this)" onchange="CalFinDedct('message1','message2')">원
                    <span id="message2" class="message"></span>
                </div>
                <div  style="padding-left: 20px; padding-top: 20px;">
                    만일 상속재산 일부를 금융재산으로 변경하시는 경우가 궁금하시면, 아래에 금액을  입력하여 시뮬레이션결과를 확인할 수 있습니다.
                </div>
                <div  style="padding-left: 20px; ">
                    추가된 금융재산 가액: <input type="text" id="financial_value2" name="financial_value2" oninput="formatNumber(this)" onchange="CalFinDedct('message1','message2')">원
                </div>
                <div style="padding-left: 20px; padding-top: 20px;">
                    <table class="result-table col-md-8">
                        <thead >
                        <tr class="table-head-hk">
                            <th>구 분</th>
                            <th>금 액</th>
                        </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>금융재산</td>
                                <td class = "amount-align-hk" id="financial_value_p2"></td>
                            </tr>
                            <tr>
                                <td>금융채무</td>
                                <td class = "amount-align-hk" id="debt_value_p2"></td>
                            </tr>
                            <tr>
                                <td>순금융재산</td>
                                <td class = "amount-align-hk" id="net_value_p2"></td>
                            </tr>
                            <tr>
                                <td>금융공제액</td>
                                <td class = "amount-align-hk" id="fin_dedct_p2" ></td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                <p style="padding-left: 20px;" class="result-description pt-2"> 이를 기준으로 상속세가   <b id="pay_tax_b"></b>원에서 <b id="pay_tax_fin_exact"></b>원으로 <b>금융상속공제활용</b>을 통해 <b id="pay_tax_exact_margin"></b>원이 추가로 절세됩니다.
                </p>
            </p>
        </div>
        <div style="padding-left: 20px;" class="description pt-3">
            <p><strong> [ 동거주택상속공제 ]  </strong></p>
            <p> - 동거주택가격의 100%를 공제합니다. 다만, 6억을 한도로 하며 다음의 요건을 충족해야 합니다.
                <br>1) 사망일 전 부터 10년이상 계속 같이 하나의 주택에서 거주
                <br>2) 동거한 자녀가 직접 상속받을 것
            </p>
            <p>- (간편계산)입력하신 주택 기준 공제액과 절세액
                <p  style="padding-left: 20px;">
                    동거주택가액: <b id="house_value_p"></b>원 (주택담보 채무액은 없는 것으로 간주)
                    </p>
                    <p style="padding-left: 20px;" class="result-description"> 이를 기준으로 상속세가   <b id="pay_tax_f_basic"></b>원에서 <b id="pay_tax_h_basic"></b>원으로 <b>동거주택상속공제활용</b>을 통해 <b id="pay_tax_h_margin"></b>원이 추가로 절세됩니다.
                    </p>
            </p>
            <p>- (정확한계산)주택담보 채무액이 포함되어 있다면 이를 입력해 주세요
                <p  style="padding-left: 20px;">
                    동거주택가액: <b id="house_value_p2"></b>원 (주택담보 채무액: <input type="text" id="house_debt" name="house_debt" oninput="formatNumber(this)" onchange="CalAlongDedct()">원)
                    </p>
                    <p style="padding-left: 20px;" class="result-description"> 이를 기준으로 상속세가   <b id="pay_tax_f"></b>원에서 <b id="pay_tax_h_exact"></b>원으로 <b>동거주택상속공제활용</b>을 통해 <b id="pay_tax_h_exact_margin"></b>원이 추가로 절세됩니다.
                    </p>
                </p>
        </div>
    </div>
    <div class="report-container col-12 pt-5">
        <div>◈ 상속세 절세 결과 요약테이블</div>
        <div style="padding-left: 20px;" class="description pt-3">
            <p>- '간편계산'은 추가입력없이 최초입력값을 기준으로 추정된 값입니다</p>
            <p> - '정확한계산'은 추가로 입력한 값을 기준으로 계산된 값입니다</p>
        </div>
        <div style="padding-left: 20px;" class="description pt-3">
            <table class="result-table col-md-12">
                <thead >
                <tr class="table-head-hk">
                    <th>구 분</th>
                    <th>간편계산</th>
                    <th>정학한계산</th>
                </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>(1) 공제적용 전 상속세</td>
                        <td class = "amount-align-hk" id="t11"></td>
                        <td class = "amount-align-hk" id="t12"></td>
                    </tr>
                    <tr>
                        <td>(2) 인적공제절세액(공제금액)</td>
                        <td class = "amount-align-hk" id="t21"></td>
                        <td class = "amount-align-hk" id="t22"></td>
                    </tr>
                    <tr>
                        <td>(3) 금융공제절세액(공제금액)</td>
                        <td class = "amount-align-hk" id="t31"></td>
                        <td class = "amount-align-hk" id="t32"></td>
                    </tr>
                    <tr>
                        <td>(4) 주택공제절세액(공제금액)</td>
                        <td class = "amount-align-hk" id="t41"></td>
                        <td class = "amount-align-hk" id="t42"></td>
                    </tr>
                    <tr class="table-tail-hk">
                        <td>(5) 최종상속세(총공제금액)</td>
                        <td class = "amount-align-hk" id="t51"></td>
                        <td class = "amount-align-hk" id="t52"></td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div> 

    <!--report 끝-->

    <p style="margin:0cm 0cm 10pt; text-align:justify">&nbsp;</p>

    <p style="margin:0cm 0cm 10pt; text-align:justify">&nbsp;</p>

    <button class="fixedButton" type="button" onclick="goBack()">입력페이지로 돌아가기</button>
    </div> <!-- end of resultPage -->

            </div> <!-- py-5 클래스 추가 end-->
        </div>
    </div>

</div> <!-- end of container my-5 클래스 추가 -->

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ENjdO4Dr2bkBIFxQpeoTz1HIcje39Wm4jDKdf19U8gI4ddQ3GYNS7NTKfAdVQSZe" crossorigin="anonymous"></script>

    <script src="https://cdn.jsdelivr.net/npm/feather-icons@4.28.0/dist/feather.min.js" integrity="sha384-uO3SXW5IuS1ZpFPKugNNWqTZRRglnUJK6UAZ/gxOX80nxEkN9NcGZTftn6RzhGWE" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.2.1/dist/chart.umd.min.js" integrity="sha384-gdQErvCNWvHQZj6XZM0dNsAoY4v+j5P1XDpNkcM3HJG1Yx04ecqIHk7+4VBOCHOG" crossorigin="anonymous"></script>
    <script>
        function formatNumber(input) {
            // Remove commas and non-numeric characters
            let numericValue = input.value.replace(/,/g, '').replace(/\D/g, '');
            // Format with commas and update the input value
            input.value = numericValue.replace(/\B(?=(\d{3})+(?!\d))/g, ",");
        }

        document.addEventListener('DOMContentLoaded', function() {
            const toggleInputs = document.querySelectorAll('.toggle-input');
            
            toggleInputs.forEach(function(input) {
                input.addEventListener('change', function() {
                    const inputBlock = this.parentNode.querySelector('.input-block');
                    const inputBlockValue = this.parentNode.querySelector('.input-block-value');
//                    alert(inputBlock);
//                    alert(inputBlockValue);
                    if (this.checked) {
                        inputBlock.style.display = 'block';
                    } else {
                        inputBlock.style.display = 'none';
                        
                        // uncheck 시 입력 필드의 값을 0으로 설정
                        inputBlockValue.value = '';
//                        if (typeof formatNumber === 'function') {
//                           formatNumber(inputBlockValue);
//                        }   
//                        inputBlockValue.dispatchEvent(new Event('input', { bubbles: true }));
                    }
                });
            });
        });

        function getInput() {
            const form = document.getElementById('inheritanceForm');
            const formData = new FormData(form);
            const resultTable = document.getElementById('resultTable').getElementsByTagName('tbody')[0];

            // 테이블 초기화
            resultTable.innerHTML = '';

            // 파라미터 매핑 (한글 이름으로 표시하기 위함)
            const paramMapping = {
                'spouse': '배우자 상속대상 여부',
                'children': '상속인이 되는 자녀의 수',
                'house_value': '주택 거래가액',
                'funeral_facility': '봉안시설 등에 소요된 금액',
                'funeral_cost': '총 장례비용',
                'building': '비거주용 건물(대지포함)',
                'building_value': '비거주용 건물 가액',
                'farmland': '농지',
                'farmland_value': '농지 가액',
                'forest': '임야(산)',
                'forest_value': '임야 가액',
                'financial': '금융자산 등 그외 상속재산',
                'financial_value': '금융자산 등 그외 상속재산 가액',
                'debt': '채무 및 공과금',
                'debt_value': '채무 및 공과금 가액',
                'spouse_gift': '10년 이내 배우자 증여금액',
                'spouse_gift_value': '10년 이내 배우자 증여금액',
                'child_gift': '10년 이내 자녀 증여금액',
                'child_gift_value': '10년 이내 자녀 증여금액',
                'other_gift': '5년 이내 상속인외 증여금액(손자,손녀 등)',
                'other_gift_value': '5년 이내 상속인외 증여금액(손자,손녀 등)',
                'appraisal_fee': '감정평가수수료',
                'appraisal_fee_value': '감정평가수수료',
                'pre_paid_tax': '사전 증여 시 납부한 세액',
                'pre_paid_tax_value': '사전 증여 시 납부한 세액'

            };

            // 폼 데이터 순회하며 테이블에 추가
            for (const [key, value] of Array.from(formData.entries()).slice(0)) {
                if (value && value !== 'on') {  // 값이 있고 'on'이 아닌 경우에만 표시
                    const row = resultTable.insertRow();
//                    const cell0 = row.insertCell(0);
//                    const cell00 = row.insertCell(1);
                    const cell1 = row.insertCell(0);
                    const cell2 = row.insertCell(1);
                    
                    cell1.textContent = paramMapping[key] || key;  // 매핑된 이름이 있으면 사용, 없으면 키 그대로 사용
                    if(key === 'children') {
                        cell2.textContent = value+'명';
                    } else {
                        cell2.textContent = value+'원';
                    }                    

                    // 체크박스 항목의 경우 '예/아니오'로 표시
                    if (value === 'on') {
                        cell2.textContent = '대상';
                    } else if (key === 'spouse' && value === '1') {
                        cell2.textContent = '대상';
                    }

                    //cell style
//                    cell0.style.cssText = "border:none; height:24.0pt; padding-right:1px; padding-left:1px; vertical-align:middle; white-space:nowrap";
//                    cell00.style.cssText = "border:none; height:24.0pt; padding-right:1px; padding-left:1px; vertical-align:middle; white-space:nowrap";
                    cell1.style.cssText = "border:none; border-bottom:0.3pt solid #595959; border-top:none; border-right:none; border-left:none; padding: 5px 10px; vertical-align:middle; white-space:nowrap; font-size:11pt; color:black; font-weight:400; font-style:normal; text-decoration:none; font-family:'맑은 고딕',monospace;";
                    cell2.style.cssText = "border:none; border-bottom:0.3pt solid #595959; border-top:none; border-right:none; border-left:none; padding: 5px 10px; vertical-align:middle; white-space:nowrap; font-size:11pt; color:black; font-weight:400; font-style:normal; text-decoration:none; font-family:'맑은 고딕',monospace;";
                }
            }

            // 결과가 없는 경우 메시지 표시
            if (resultTable.rows.length === 0) {
                const row = resultTable.insertRow();
                const cell = row.insertCell(0);
                cell.colSpan = 2;
                cell.textContent = '입력된 데이터가 없습니다.';
            }

            // 입력 페이지 숨기고 결과 페이지 표시
            document.getElementById('inputPage').style.display = 'none';
            document.getElementById('resultPage').style.display = 'block';

            //세금계산 함수 call
            calculate_inherit();
        }

        function goBack() {
            // 결과 페이지 숨기고 입력 페이지 표시
            document.getElementById('resultPage').style.display = 'none';
            document.getElementById('inputPage').style.display = 'block';
        }

        
    //----------------------------------------------------------------------
    //
    //     2. 상속세 절세
    //
    //     인적상속공제의 활용 & 기타상속공제의 활용
    //
    //======================================================================
    function calculate_inherit() {
        //---- 기본입력 ----
        var spouse = parseFloat(document.getElementById('spouse').value.replace(/,/g, '')) || 0; //배우자존재여부 존재=1, 없음=0
        var children = parseFloat(document.getElementById('children').value.replace(/,/g, '')) || 0; //자녀숫자
        var house_value = parseFloat(document.getElementById('house_value').value.replace(/,/g, '')) || 0; //아파트 매매가액 시세
        var funeral_facility = parseFloat(document.getElementById('funeral_facility').value.replace(/,/g, '')) || 0; //봉안시설비용
        var funeral_cost = parseFloat(document.getElementById('funeral_cost').value.replace(/,/g, '')) || 0; //장례비용

        //---- 추가입력 ----
        var building_value = parseFloat(document.getElementById('building_value')?.value.replace(/,/g, '')) || 0;
        var farmland_value = parseFloat(document.getElementById('farmland_value')?.value.replace(/,/g, '')) || 0; 
        var forest_value = parseFloat(document.getElementById('forest_value')?.value.replace(/,/g, '')) || 0; 
        var financial_value = parseFloat(document.getElementById('financial_value')?.value.replace(/,/g, '')) || 0; 
        var debt_value = parseFloat(document.getElementById('debt_value')?.value.replace(/,/g, '')) || 0; 
        var spouse_gift_value = parseFloat(document.getElementById('spouse_gift_value')?.value.replace(/,/g, '')) || 0; 
        var child_gift_value = parseFloat(document.getElementById('child_gift_value')?.value.replace(/,/g, '')) || 0; 
        var other_gift_value = parseFloat(document.getElementById('other_gift_value')?.value.replace(/,/g, '')) || 0; 
        var appraisal_fee_value = parseFloat(document.getElementById('appraisal_fee_value')?.value.replace(/,/g, '')) || 0; 
        var pre_paid_tax_value = parseFloat(document.getElementById('pre_paid_tax_value')?.value.replace(/,/g, '')) || 0; 

        //---1. 총 상속재산가액
        var totalValue = house_value + building_value + farmland_value + forest_value + financial_value + spouse_gift_value + child_gift_value + other_gift_value;

        //---2. 장례비용 + 봉안지(추가500만원까지가능).채무,공과
        var funeral_all;

        if(!funeral_cost){funeral_cost = 5000000;}
        if(funeral_cost < 5000000){ funeral_cost = 5000000 }
        if(funeral_cost > 10000000){ funeral_cost = 10000000 }

        funeral_all = funeral_cost + Math.max(funeral_facility,5000000);

        var tax_free = funeral_all + debt_value;

        //---3. 상속세 과세가액
        var tax_price = totalValue - tax_free;
        var dct_tax_price = totalValue - debt_value; //공제용 상속가액은 장례비용제외

        //---4. 상속공제 소계: 10억 vs 배우자공제이용(금융공제,동거주택공제는 별도계산)
        var tax_dedct = 0, spouse_dedct =0, family_dedct=0; //인적공제 및 일괄공제

        if(spouse > 0 && children == 0 ) {tax_dedct = 200000000;} //여기는 해당없지만 일단 입력. 배우자 단독공제
        if(children > 0) {family_dedct = 500000000;} //자녀가 있는경우 일괄공제 5억 적용

        var spouseShare = 0; 
        if (spouse == 1) { //배우자 존재할 경우.여기서는 항상 존재하는 걸로..
            spouseShare = 1.5/(1.5 + children);
            let s1 = dct_tax_price; //배우자가 최대 상속받았다고 가정
            let s2 = Math.floor(dct_tax_price*spouseShare); //배우자의 법정상속분
            let s3 = 3000000000; //배우자 최대상속액 30억
            spouse_dedct = Math.min(s1,s2,s3);

            //5억이하이면 5억으로
            if(spouse_dedct < 500000000) {spouse_dedct = 500000000;}
        }
        tax_dedct = spouse_dedct + family_dedct;

        var net_fin = Math.max(financial_value - debt_value,0); //금융공제.은행빚이있는경우차감
        var finDedct = 0;
        if(net_fin <= 20000000) { finDedct = net_fin}
        else {finDedct = Math.min(200000000, Math.max(20000000, net_fin*0.2));}

        var alongDedct = 0; //동거주택상속공제
        alongDedct = Math.min(house_value, 600000000);

        var totalDedct0 = 1000000000 + appraisal_fee_value; //재우자,자녀 기본 일괄공제 10억
        var totalDedct1 = family_dedct + spouse_dedct + appraisal_fee_value; //인적공제만
        var totalDedct2 = family_dedct + spouse_dedct + finDedct + appraisal_fee_value; //인적공제+금융공제
        var totalDedct3 = family_dedct + spouse_dedct + finDedct + alongDedct + appraisal_fee_value; //인적공제+금융공제+동거주택공제

        //--3. 과세표준
        var tax_base0 = Math.max(0, tax_price - totalDedct0);
        var tax_base1 = Math.max(0, tax_price - totalDedct1);
        var tax_base2 = Math.max(0, tax_price - totalDedct2);
        var tax_base3 = Math.max(0, tax_price - totalDedct3);

        //---4. 산출세액
        const [r0, acc0] = CallTariff(tax_base0);
        const [r1, acc1] = CallTariff(tax_base1);
        const [r2, acc2] = CallTariff(tax_base2);
        const [r3, acc3] = CallTariff(tax_base3);

        var cal_tax0 = Math.floor(tax_base0*r0 - acc0);
        var cal_tax1 = Math.floor(tax_base1*r1 - acc1);
        var cal_tax2 = Math.floor(tax_base2*r2 - acc2);
        var cal_tax3 = Math.floor(tax_base3*r3 - acc3);

        //-- 세액공제
        var tax_dedct0 = pre_paid_tax_value + Math.floor((cal_tax0 - pre_paid_tax_value)*0.03);
        var tax_dedct1 = pre_paid_tax_value + Math.floor((cal_tax1 - pre_paid_tax_value)*0.03);
        var tax_dedct2 = pre_paid_tax_value + Math.floor((cal_tax2 - pre_paid_tax_value)*0.03);
        var tax_dedct3 = pre_paid_tax_value + Math.floor((cal_tax3 - pre_paid_tax_value)*0.03);

        //--5. 결정세액
        var pay_tax0 = Math.floor((cal_tax0 - tax_dedct0)/10)*10; //사전납입 공제율3%
        var pay_tax1 = Math.floor((cal_tax1 - tax_dedct1)/10)*10; //사전납입 공제율3%
        var pay_tax2 = Math.floor((cal_tax2 - tax_dedct2)/10)*10; //사전납입 공제율3%
        var pay_tax3 = Math.floor((cal_tax3 - tax_dedct3)/10)*10; //사전납입 공제율3%
        
        //계산결과 출력
        document.getElementById('totalValue0').textContent = totalValue.toLocaleString();   //(1) 총 상속재산가액
        document.getElementById('totalValue1').textContent = totalValue.toLocaleString();   //(1) 총 상속재산가액
        document.getElementById('tax_free0').textContent = tax_free.toLocaleString();   //(2) 장례비용,채무 및 공과금
        document.getElementById('tax_free1').textContent = tax_free.toLocaleString();   //(2) 장례비용,채무 및 공과금
        document.getElementById('tax_price0').textContent = tax_price.toLocaleString();   //(3) 상속세 과세가액
        document.getElementById('tax_price1').textContent = tax_price.toLocaleString();   //(3) 상속세 과세가액
        document.getElementById('tax_dedct').textContent = (spouse_dedct + 
        family_dedct).toLocaleString();   //(4) 상속공제 소계
        document.getElementById('spouse_dedct').textContent = spouse_dedct.toLocaleString();   //배우자공제
        document.getElementById('family_dedct').textContent = family_dedct.toLocaleString();   //인적공제
        document.getElementById('app_fee0').textContent = appraisal_fee_value.toLocaleString();   //(5)감정평가수수료
        document.getElementById('app_fee1').textContent = appraisal_fee_value.toLocaleString();   //(5)감정평가수수료
        document.getElementById('tax_base0').textContent = tax_base0.toLocaleString();   //(6)상속세과세표준
        document.getElementById('tax_base1').textContent = tax_base1.toLocaleString();   //(6)상속세과세표준
        document.getElementById('tax_rate0').textContent = r0.toLocaleString();   //(7)세율
        document.getElementById('tax_rate1').textContent = r1.toLocaleString();   //(7)세율
        document.getElementById('tax_acc_dedct0').textContent = acc0.toLocaleString();   //(8)누진공제액
        document.getElementById('tax_acc_dedct1').textContent = acc1.toLocaleString();   //(8)누진공제액
        document.getElementById('cal_tax0').textContent = cal_tax0.toLocaleString();   //(9)산출세액
        document.getElementById('cal_tax1').textContent = cal_tax1.toLocaleString();   //(9)산출세액
        document.getElementById('cal_tax_dedct0').textContent = Math.floor(cal_tax0*0.03).toLocaleString();   //(10)세액공제
        document.getElementById('cal_tax_dedct1').textContent = Math.floor(cal_tax1*0.03).toLocaleString();   //(10)세액공제
        document.getElementById('pay_tax0').textContent = pay_tax0.toLocaleString();   //(11)자진납부세액
        document.getElementById('pay_tax1').textContent = pay_tax1.toLocaleString();   //(11)자진납부세액

        document.getElementById('pay_tax0_p').textContent = pay_tax0.toLocaleString(); 
        document.getElementById('pay_tax1_p').textContent = pay_tax1.toLocaleString(); 
        document.getElementById('pay_tax_margin0').textContent = (pay_tax0-pay_tax1).toLocaleString(); 

        //금융상속공제활용 출력
        document.getElementById('financial_value_p').textContent = financial_value.toLocaleString();   
        document.getElementById('debt_value_p').textContent = debt_value.toLocaleString();   
        document.getElementById('net_value_p').textContent = Math.max(financial_value - debt_value,0).toLocaleString();   
        document.getElementById('fin_dedct_p').textContent = finDedct.toLocaleString();   
        document.getElementById('pay_tax_fin1').textContent = pay_tax1.toLocaleString();   
        document.getElementById('pay_tax_fin2').textContent = pay_tax2.toLocaleString();   
        document.getElementById('pay_tax_margin').textContent = (pay_tax1 - pay_tax2).toLocaleString();
        //정확한계산전 디폴트값입력
        document.getElementById('pay_tax_b').textContent = pay_tax1.toLocaleString();   
        document.getElementById('pay_tax_fin_exact').textContent = pay_tax1.toLocaleString();   
        document.getElementById('pay_tax_exact_margin').textContent = 0;


        //동거주택상속공제
        document.getElementById('house_value_p').textContent = house_value.toLocaleString();   
        document.getElementById('pay_tax_f_basic').textContent = pay_tax2.toLocaleString();   
        document.getElementById('pay_tax_h_basic').textContent = pay_tax3.toLocaleString();   
        document.getElementById('pay_tax_h_margin').textContent = (pay_tax2 - pay_tax3).toLocaleString();   
        //정확한계산전 디폴트값입력
        document.getElementById('house_value_p2').textContent = house_value.toLocaleString();   
        CalAlongDedct();

        //상속세절세 요약테이블값 입력
        document.getElementById('t11').textContent = pay_tax0.toLocaleString()+'원';  
        document.getElementById('t12').textContent = pay_tax0.toLocaleString()+'원';  
        document.getElementById('t21').textContent = (pay_tax0-pay_tax1).toLocaleString()+'원 ( '+(spouse_dedct + 
        family_dedct).toLocaleString()+'원)';  
        document.getElementById('t22').textContent = (pay_tax0-pay_tax1).toLocaleString()+'원 ( '+(spouse_dedct + 
        family_dedct).toLocaleString()+'원) ';  
        document.getElementById('t31').textContent = (pay_tax1 - pay_tax2).toLocaleString()+'원 ( '+finDedct.toLocaleString()+'원) ';
        document.getElementById('t32').textContent = '0원( 0원) ';
        document.getElementById('t41').textContent = (pay_tax2 - pay_tax3).toLocaleString()+'원 ( '+alongDedct.toLocaleString()+'원) ';
        // 함수안에서 document.getElementById('t42').textContent = 0;
        // t52도 함수안에서
        document.getElementById('t51').textContent = pay_tax3.toLocaleString()+'원 ( '+totalDedct3.toLocaleString()+'원) ';

    }

    function CallTariff(tax_base) {
        var r =0,acc=0;
        if(tax_base <= 100000000){r = 0.1;acc = 0;} else
        if(tax_base <= 500000000){r = 0.2;acc = 10000000;} else
        if(tax_base <= 1000000000){r = 0.3;acc = 60000000;} else
        if(tax_base <= 3000000000){r = 0.4;acc = 160000000;} else
        if(tax_base > 3000000000){r = 0.5;acc = 460000000;}

        return [r,acc];
    }

    //-------------------------------
    // (정확한계산용) 한도체크 및 금융상속공제 추가적용(인적공제포함)
    //-------------------------------
    function CalFinDedct(mss_id1,mss_id2){
        //최초금융및기타재산, 채무값-한도액체크용
        var financial_value = parseFloat(document.getElementById('financial_value')?.value.replace(/,/g, '')) || 0; 
        var debt_value = parseFloat(document.getElementById('debt_value')?.value.replace(/,/g, '')) || 0; 
        let message1 = document.getElementById(mss_id1);
        let message2 = document.getElementById(mss_id2);

        //실제 금융및채무값
        var financial_value1 = parseFloat(document.getElementById('financial_exact')?.value.replace(/,/g, '')) || 0;
        var financial_value2 = parseFloat(document.getElementById('financial_value2')?.value.replace(/,/g, '')) || 0;
        var debt_value1 = parseFloat(document.getElementById('fin_debt_exact')?.value.replace(/,/g, '')) || 0;
        var tax_dedct = parseFloat(document.getElementById('tax_dedct')?.textContent.replace(/,/g, '')) || 0; //배우자공제+인적공제
        var app_fee = parseFloat(document.getElementById('app_fee1')?.textContent.replace(/,/g, '')) || 0; //감정평가비용
        var tax_price = parseFloat(document.getElementById('tax_price1')?.textContent.replace(/,/g, '')) || 0; //(3)상속세 상속가액
        var pre_paid_tax_value = parseFloat(document.getElementById('pre_paid_tax_value')?.value.replace(/,/g, '')) || 0;  //사전납부증여세
        var pay_tax1 = parseFloat(document.getElementById('pay_tax1')?.textContent.replace(/,/g, '')) || 0; //(11)일괄공제 포함 이전납부세액

        // 최초입력금액초과 여부 체크
        if(financial_value < financial_value1){
            //alert('금융재산 가액은 최초에 입력한 "금융자산 등 그외 상속재산 가액"을 초과할 수 없습니다. 한도액인 최초입력금액으로 설정됩니다. 수정하시려면 입력페이지로 돌아가서 입력하시기 바랍니다. ');
            financial_value1 = financial_value;
//            showModal(financial_value);
            message1.textContent = " '금융자산 등 그외 상속재산 가액'을 초과할 수 없습니다. 입력금액을 한도로 계산됩니다"
        }
        if(debt_value < debt_value1){
            //alert('금융채무 가액은 최초에 입력한 "채무 및 공과금 가액"을 초과할 수 없습니다. 한도액인 최초입력금액으로 설정됩니다. 수정하시려면 입력페이지로 돌아가서 입력하시기 바랍니다. ');
            debt_value1 = debt_value;
            message2.textContent = " '채무 및 공과금 가액'을 초과할 수 없습니다. 입력금액을 한도로 계산됩니다."
        }
        var net_fin = Math.max(financial_value1 + financial_value2 - debt_value1,0); //금융공제.은행빚이있는경우차감

        var finDedct = 0;
        if(net_fin <= 20000000) { finDedct = net_fin}
        else {finDedct = Math.min(200000000, Math.max(20000000, net_fin*0.2));}

        var totalDedct = tax_dedct + finDedct + app_fee; //인적공제+금융공제+감정평가비용


        //--3. 과세표준
        var tax_base = Math.max(0, tax_price - totalDedct);

        //---4. 산출세액
        const [r, acc] = CallTariff(tax_base);

        var cal_tax = Math.floor(tax_base*r - acc);

        //-- 세액공제 - 사전납입3%+사전증여세납입
        var tax_dedct = pre_paid_tax_value + Math.floor((cal_tax - pre_paid_tax_value)*0.03);

        //--5. 결정세액
        var pay_tax = Math.floor((cal_tax - tax_dedct)/10)*10; 
        
        //계산결과 출력
        document.getElementById('financial_exact').textContent = financial_value.toLocaleString();   
        document.getElementById('fin_debt_exact').textContent = debt_value.toLocaleString();   

        document.getElementById('financial_value_p2').textContent = (financial_value1 + financial_value2).toLocaleString();   
        document.getElementById('debt_value_p2').textContent = debt_value1.toLocaleString();   
        document.getElementById('net_value_p2').textContent = net_fin.toLocaleString();   
        document.getElementById('fin_dedct_p2').textContent = finDedct.toLocaleString();   

        document.getElementById('pay_tax_b').textContent = pay_tax1.toLocaleString();   
        document.getElementById('pay_tax_fin_exact').textContent = pay_tax.toLocaleString();   
        document.getElementById('pay_tax_exact_margin').textContent = (pay_tax1 - pay_tax).toLocaleString();   
        document.getElementById('t32').textContent = (pay_tax1 - pay_tax).toLocaleString()+'원 ( '+finDedct.toLocaleString()+'원) ';

        //주택공제 재설정
        CalAlongDedct();
    }

    //-------------------------------
    // (정확한계산용) 동거주택상속공제 적용(인적공제,금융공제포함)
    //-------------------------------
    function CalAlongDedct(){
        var house_value = parseFloat(document.getElementById('house_value').value.replace(/,/g, '')) || 0; //아파트 매매가액 시세
        var debt_value = parseFloat(document.getElementById('house_debt')?.value.replace(/,/g, '')) || 0; //주택담보채무액
        var tax_dedct = parseFloat(document.getElementById('tax_dedct')?.textContent.replace(/,/g, '')) || 0; //배우자공제+인적공제
        var fin_dedct = parseFloat(document.getElementById('fin_dedct_p2')?.textContent.replace(/,/g, '')) || 0; //금융상속공제
        var app_fee = parseFloat(document.getElementById('app_fee1')?.textContent.replace(/,/g, '')) || 0; //감정평가비용
        var tax_price = parseFloat(document.getElementById('tax_price1')?.textContent.replace(/,/g, '')) || 0; //(3)상속세 상속가액
        var pre_paid_tax_value = parseFloat(document.getElementById('pre_paid_tax_value')?.value.replace(/,/g, '')) || 0;  //사전납부증여세
        var pay_tax1 = parseFloat(document.getElementById('pay_tax_fin_exact')?.textContent.replace(/,/g, '')) || 0; //금융공제까지포함된 이전 상속세

        var alongDedct = 0; //동거주택상속공제
        alongDedct = Math.min(Math.max(house_value - debt_value,0), 600000000);
//alert(alongDedct);
        var totalDedct = tax_dedct + fin_dedct + alongDedct + app_fee; //인적공제+금융공제+감정평가비용


        //--3. 과세표준
        var tax_base = Math.max(0, tax_price - totalDedct);

        //---4. 산출세액
        const [r, acc] = CallTariff(tax_base);

        var cal_tax = Math.floor(tax_base*r - acc);

        //-- 세액공제 - 사전납입3%+사전증여세납입
        var tax_dedct = pre_paid_tax_value + Math.floor((cal_tax - pre_paid_tax_value)*0.03);

        //--5. 결정세액
        var pay_tax = Math.floor((cal_tax - tax_dedct)/10)*10; 
        
        //계산결과 출력
        document.getElementById('pay_tax_f').textContent = pay_tax1.toLocaleString();   
        document.getElementById('pay_tax_h_exact').textContent = pay_tax.toLocaleString();   
        document.getElementById('pay_tax_h_exact_margin').textContent = (pay_tax1 - pay_tax).toLocaleString();   
        document.getElementById('t42').textContent = (pay_tax1 - pay_tax).toLocaleString()+'원 ( '+alongDedct.toLocaleString()+'원) ';   
        document.getElementById('t52').textContent = pay_tax.toLocaleString()+'원 ( '+totalDedct.toLocaleString()+'원) ';   

    }

//팝업창관리
        function showModal(input) {
            document.getElementById('financial_exact').textContent = input.toLocaleString();   

            document.getElementById("myModal").style.display = "block";
        }

        function closeModal() {
            document.getElementById("myModal").style.display = "none";
        }

        // 모달 외부 클릭 시 닫기
        window.onclick = function(event) {
            if (event.target == document.getElementById("myModal")) {
                closeModal();
            }
        }
</script>

</body>
</html>
